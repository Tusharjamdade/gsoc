<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Avro File Analysis — GSoC 2025 End Evaluation</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Poppins:wght@600;700&display=swap"
    rel="stylesheet">
  <style>
    /* =====================
       Design tokens (light first)
       ===================== */
    :root {
      --bg: #ffffff;
      --muted: #6b7280;
      --text: #0f172a;
      --accent: #6d28d9;
      --accent-2: #06b6d4;
      --surface: #ffffff;
      --divider: #e6e9ef;
      --radius: 10px;
      --container: 1100px;
      --shadow-soft: 0 6px 18px rgba(16, 24, 40, 0.06);
      --glass-border: rgba(15, 23, 42, 0.04);
    }

    [data-theme="dark"] {
      --bg: linear-gradient(180deg, #071025 0%, #071229 60%);
      --muted: #9aa4b2;
      --text: #e6eef7;
      --accent: #8b5cf6;
      --accent-2: #06b6d4;
      --surface: rgba(8, 12, 20, 0.6);
      --divider: rgba(255,255,255,0.06);
      --shadow-soft: 0 8px 26px rgba(2,6,23,0.6);
      --glass-border: rgba(255,255,255,0.06);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background: var(--bg); color: var(--text); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }

    /* Header */
    header.site-header {
      position: sticky; top: 0; z-index: 1200; display:flex; align-items:center; gap: 16px; padding: 14px 20px; background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.85)); border-bottom: 1px solid var(--divider); box-shadow: var(--shadow-soft);
    }
    [data-theme="dark"] header.site-header { background: rgba(7,10,21,0.75); }

    .brand { display:flex; align-items:center; gap:12px; }
    .logo-img { width:44px; height:44px; border-radius:8px; object-fit:contain; }
    .brand h1 { margin:0; font-size:1.05rem; letter-spacing: -0.2px; }
    .brand p { margin:0; font-size:0.78rem; color:var(--muted); }

    .header-actions { margin-left:auto; display:flex; gap:8px; align-items:center; }
    .theme-toggle { background:transparent; border:1px solid var(--glass-border); padding:8px; border-radius:8px; cursor:pointer; display:inline-flex; align-items:center; justify-content:center; }
    .theme-toggle svg { width:18px; height:18px; }

    /* Layout */
    .container { max-width: var(--container); margin: 30px auto; padding: 20px; display: grid; grid-template-columns: 240px 1fr; gap: 28px; }

    aside.sidebar { position: sticky; top: 84px; align-self:start; padding-right: 10px; }
    .sidebar nav { background: transparent; border-right: none; }
    .sidebar ul { list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:8px; }
    .sidebar a { color:var(--text); text-decoration:none; padding:8px 10px; border-radius:8px; display:block; font-weight:600; font-size:0.95rem; }
    .sidebar a:hover { background: rgba(109,40,217,0.06); color:var(--accent); transform: translateX(6px); transition: all .18s ease; }
    .sidebar a.active { background: rgba(109,40,217,0.09); color:var(--accent); }

    section.main { background: transparent; }

    /* Documentation sections (no cards) */
    .doc-section { padding:22px 22px 10px 22px; background: transparent; border-radius:8px; border-bottom: 1px solid var(--divider); margin-bottom:18px; }
    .doc-section h2 { margin:0 0 8px 0; font-size:1.15rem; }
    .doc-section h3 { margin:8px 0 12px 0; color:var(--accent); font-size:1rem; }
    .doc-section p { color:var(--muted); line-height:1.6; margin:6px 0 12px 0; }
    .meta-table { width:100%; border-collapse:collapse; margin-top:12px; }
    .meta-table td { padding:8px 10px; vertical-align:top; }
    .meta-table tr { border-bottom:1px dashed var(--divider); }

    /* Images used as examples in documentation */
    .doc-image { display:block; width:100%; max-width:900px; height:auto; margin:12px 0; border-radius:8px; box-shadow: var(--shadow-soft); border:1px solid var(--glass-border); }
    .image-caption { font-size:0.85rem; color:var(--muted); margin-top:6px; }

    /* Code blocks / inline code styling */
    pre.code-block { background: linear-gradient(180deg, rgba(245,247,250,1), rgba(240,243,247,1)); padding:12px; border-radius:8px; overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, monospace; font-size:0.92rem; border:1px solid var(--divider); }
    [data-theme="dark"] pre.code-block { background: rgba(10,12,16,0.6); }
    code.inline { background: rgba(0,0,0,0.03); padding:2px 6px; border-radius:6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, monospace; }

    /* Footer */
    footer.site-footer { text-align:center; padding:18px 20px; color:var(--muted); font-size:0.9rem; border-top:1px solid var(--divider); margin-top:32px; }

    /* Responsive */
    @media(max-width:900px) {
      .container { grid-template-columns: 1fr; padding:16px; }
      aside.sidebar { position:relative; top:auto; }
    }
  </style>
</head>

<body>
  <header class="site-header">
    <div class="brand">
      <img src="img/gsoc.png" alt="GSoC logo" class="logo-img">
      <div>
        <h1>GSoC 2025 — Avro File Analysis</h1>
        <p>@ Data For The Common Good</p>
      </div>
    </div>

    <div class="header-actions">
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme" title="Toggle theme">
        <svg id="themeIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <!-- will be replaced by JS -->
        </svg>
      </button>
    </div>
  </header>

  <main class="container" id="mainContainer">
    <aside class="sidebar" aria-label="Documentation navigation">
      <nav>
        <ul>
          <li><a href="#details" class="active">Project Information</a></li>
          <li><a href="#overview">Overview</a></li>
          <li><a href="#workflow">Workflow</a></li>
          <li><a href="#distribution">Percentage Distribution</a></li>
          <li><a href="#survival">Survival Curves</a></li>
          <li><a href="#table1">Table 1 Analysis</a></li>
        </ul>
      </nav>
    </aside>

    <section class="main" id="content">

      <article id="details" class="doc-section">
        <h2>Project Information</h2>
        <table class="meta-table">
          <tr>
            <td style="width:130px"><strong>Name</strong></td>
            <td>Tushar Jamdade</td>
          </tr>
          <tr>
            <td><strong>Organization</strong></td>
            <td><a href="https://commons.cri.uchicago.edu/" target="_blank" rel="noopener">Data for the Common Good (D4CG)</a></td>
          </tr>
          <tr>
            <td><strong>Mentor</strong></td>
            <td>Steve Krasinsky</td>
          </tr>
          <tr>
            <td><strong>Project Repo</strong></td>
            <td><a href="https://github.com/chicagopcdc/pcdc-analysis-notebook" target="_blank" rel="noopener">pcdc-analysis-notebook</a></td>
          </tr>
          <tr>
            <td><strong>Technologies</strong></td>
            <td>R, Docker, Apache Spark, RStudio, Shiny</td>
          </tr>
          <tr>
            <td><strong>Topics</strong></td>
            <td>Visualization, Automation, Cloud, Data Analysis, AVRO</td>
          </tr>
        </table>
      </article>

      <article id="overview" class="doc-section">
        <h2>Overview</h2>
        <h3>Dockerized R/Shiny Application for PFB AVRO Biomedical Data Analysis</h3>
        <p>
          This project provides a Dockerized RStudio-based Shiny application for analyzing biomedical datasets stored in
          AVRO files using the Portable Format for Biomedical (PFB) standard. The system leverages Apache Spark (via
          sparklyr) to read and process large AVRO inputs and flattens complex hierarchical structures into tidy
          tabular formats for downstream analysis.
        </p>

        <p>
          Users can explore entities and observation nodes, generate percentage distributions, and perform survival
          analyses (Kaplan–Meier). A configurable Table-1 feature allows selection of covariates and statistical
          comparisons when grouping is applied. Outputs (Excel, PNG) are download-ready for reporting.
        </p>

        <img src="img/avrodata.png" alt="AVRO nested data" class="doc-image">
        <div class="image-caption">Example: nested AVRO structure before flattening.</div>
      </article>

      <article id="workflow" class="doc-section">
        <h2>Workflow</h2>
        <p>
          Users upload a PFB AVRO file. Valid files expose available entities. Core entities such as
          <code class="inline">person</code>, <code class="inline">subject</code>, <code class="inline">timing</code>, and
          <code class="inline">survival_characteristics</code> are included by default for survival analyses. Additional
          entities may be selected by the user.
        </p>

        <p>
          The application flattens nested records into a tidy table, preserves relationships, and merges entity-level
          information for analyses like distribution counts and survival curves.
        </p>

        <img src="img/flatten1.png" alt="Flattened table" class="doc-image">
        <div class="image-caption">After flattening, AVRO data is converted to a tabular form suitable for analysis.</div>
      </article>

      <article id="distribution" class="doc-section">
        <h2>Percentage Distribution</h2>
        <p>Select categorical variables to compute percentage distributions and download results as Excel or PNG.</p>

        <img src="img/image1.png" alt="Percentage distribution" class="doc-image">
        <div class="image-caption">Distribution visualization (exportable).</div>
      </article>

      <article id="survival" class="doc-section">
        <h2>Survival Curves</h2>
        <h3>Overall Survival</h3>
        <p>
          Overall survival uses diagnosis and last-known outcome from <code class="inline">survival_characteristics</code>.
          Kaplan–Meier estimators are used to generate survival plots and downloadable PNGs with risk tables.
        </p>

        <img src="img/image2.png" alt="Overall survival" class="doc-image">

        <h3>Event-Free Survival</h3>
        <p>
          Event-free survival uses censoring and event timing information (from <code class="inline">subject</code> and
          <code class="inline">timing</code>) to compute curves.
        </p>
        <img src="img/image3.png" alt="Event-free survival" class="doc-image">
      </article>

      <article id="table1" class="doc-section">
        <h2>Table-1 Analysis</h2>
        <p>
          Select covariates and variable types to create summary tables. Numeric variables show mean/median/missing %;
          categorical variables show counts and percentages. When a subject ID grouping file is uploaded, two groups are
          produced (IDs in file vs remaining subjects) and p-values are computed where appropriate.
        </p>

        <img src="img/image4.png" alt="Table 1" class="doc-image">
        <div class="image-caption">Interactive Table-1 output (example).</div>
        <img src="img/image5.png" alt="Table 1" class="doc-image">
        <div class="image-caption">Interactive Table-1 output (singe grouping).</div>
        <img src="img/image6.png" alt="Table 1" class="doc-image">
        <div class="image-caption">Interactive Table-1 output (grouping + P value).</div>
      </article>

    </section>
  </main>

  <footer class="site-footer">
    <div>Made for GSoC • Tushar Jamdade • &copy; 2025</div>
  </footer>

  <script>
    // Default theme: light. User can toggle to dark.
    (function () {
      const root = document.documentElement;
      const toggle = document.getElementById('themeToggle');
      const icon = document.getElementById('themeIcon');

      let theme = 'light'; // light default as requested
      root.setAttribute('data-theme', theme);

      function setIcon(t) {
        if (t === 'dark') {
          // moon icon
          icon.innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
          return;
        }
        // sun icon
        icon.innerHTML = '<circle cx="12" cy="12" r="3"></circle>\n          <path d="M12 2v2"></path>\n          <path d="M12 20v2"></path>\n          <path d="M4.2 4.2l1.4 1.4"></path>\n          <path d="M18.4 18.4l1.4 1.4"></path>\n          <path d="M2 12h2"></path>\n          <path d="M20 12h2"></path>\n          <path d="M4.2 19.8l1.4-1.4"></path>\n          <path d="M18.4 5.6l1.4-1.4"></path>';
      }

      setIcon(theme);

      toggle.addEventListener('click', () => {
        theme = (theme === 'dark') ? 'light' : 'dark';
        root.setAttribute('data-theme', theme);
        setIcon(theme);
      });

      // Small helper: mark active nav link based on hash or first link
      const links = document.querySelectorAll('.sidebar a');
      function setActiveFromHash() {
        const hash = location.hash || '#details';
        links.forEach(a => a.classList.toggle('active', a.getAttribute('href') === hash));
      }
      window.addEventListener('hashchange', setActiveFromHash);
      setActiveFromHash();

      // Smooth scroll for internal links (improve UX on smaller screens)
      document.querySelectorAll('a[href^="#"]').forEach(a => {
        a.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          history.pushState(null, '', this.getAttribute('href'));
          setActiveFromHash();
        });
      });

    })();
  </script>
</body>

</html>